<HTML>
<BODY>
<PRE>
<!-- Manpage converted by man2html 3.0.1 -->

</PRE>
<H2>NAME</H2><PRE>
     curl_formadd  -  add  a section to a multipart/formdata HTTP
     POST


</PRE>
<H2>SYNOPSIS</H2><PRE>
     <B>#include</B> <B>&lt;curl/curl.h&gt;</B>

     <B>CURLcode</B> <B>curl_formadd(struct</B> <B>HttpPost</B> <B>**</B>  <I>firstitem,</I>  <B>struct</B>
     <B>HttpPost</B> <B>**</B> <I>lastitem,</I> <B>...);</B>


</PRE>
<H2>DESCRIPTION</H2><PRE>
     curl_formadd()  is  used  to append sections when building a
     multipart/formdata  HTTP  POST  (sometimes  refered  to   as
     rfc1867-style  posts).  Append  one  section at a time until
     you've added all the sections you want included and then you
     pass the <I>firstitem</I> pointer as parameter to <B>CURLOPT_HTTPPOST</B>.
     <I>lastitem</I> is set after each call and on repeated  invokes  it
     should  be left as set to allow repeated invokes to find the
     end of the list in a faster way.

     After <I>lastitem</I> follow the real arguments that constitute the
     new  section (if the following description confuses you jump
     directly to the examples):

     CURLFORM_COPYNAME or CURLFORM_PTRNAME followed by  a  string
     is  used for the name of the section. Optionally one may use
     CURLFORM_NAMELENGTH  to  specify  the  length  of  the  name
     (allowing null characters within the name).

     The  three  options for providing values are: CURLFORM_COPY­
     CONTENTS, CURLFORM_PTRCONTENTS, or  CURLFORM_FILE,  followed
     by a char or void pointer (allowed for PTRCONTENTS).

     Other  arguments  may  be  CURLFORM_CONTENTTYPE  if the user
     wishes to specify one (for FILE if  no  type  is  given  the
     library  tries  to  provide the correct one; for CONTENTS no
     Content-Type is sent in this case)

     For CURLFORM_PTRCONTENTS or CURLFORM_COPYNAME the  user  may
     also add CURLFORM_CONTENTSLENGTH followed by the length as a
     long (if not given the library will use strlen to  determine
     the length).

     For  CURLFORM_FILE  the  user may send multiple files in one
     section by providing multiple CURLFORM_FILE  arguments  each
     followed by the filename (and each FILE is allowed to have a
     CONTENTTYPE).

     The last argument always is CURLFORM_END.

     The pointers <I>*firstitem</I> and <I>*lastitem</I> should both be  point­
     ing  to  NULL  in the first call to this function. All list-
     data will be allocated by the function itself. You must call
     <I>curl</I><B>_</B><I>formfree</I>  after the form post has been done to free the
     resources again.

     This function will copy  all  input  data  except  the  data
     pointed to by the arguments after CURLFORM_PTRNAME and CURL­
     FORM_PTRCONTENTS and keep its own version  of  it  allocated
     until you call <I>curl</I><B>_</B><I>formfree</I>. When you've passed the pointer
     to <I>curl</I><B>_</B><I>easy</I><B>_</B><I>setopt</I>, you must not free the list until  after
     you've  called <I>curl</I><B>_</B><I>easy</I><B>_</B><I>cleanup</I> for the curl handle. If you
     provide a pointer as an arguments after CURLFORM_PTRNAME  or
     CURLFORM_PTRCONTENTS  you must ensure that the pointer stays
     valid until you call <I>curl</I><B>_</B><I>form</I><B>_</B><I>free</I> and <I>curl</I><B>_</B><I>easy</I><B>_</B><I>cleanup</I>.

     See example below.


</PRE>
<H2>RETURN VALUE</H2><PRE>
     Returns non-zero if an error occurs.


</PRE>
<H2>EXAMPLE</H2><PRE>
      HttpPost* post = NULL;
      HttpPost* last = NULL;
      char namebuffer[] = "name buffer";
      long namelength = strlen(namebuffer);
      char buffer[] = "test buffer";
      char htmlbuffer[] = "&lt;HTML&gt;test buffer&lt;/HTML&gt;";
      long htmlbufferlength = strlen(htmlbuffer);
      /* add null character into htmlbuffer, to demonstrate that
         transfers of buffers containing null characters actually work
      */
      htmlbuffer[8] = '\0';

      /* Add simple name/content section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "name",
                   CURLFORM_COPYCONTENTS, "content", CURLFORM_END);
      /* Add simple name/content/contenttype section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "htmlcode",
                   CURLFORM_COPYCONTENTS, "&lt;HTML&gt;&lt;/HTML&gt;",
                   CURLFORM_CONTENTTYPE, "text/html", CURLFORM_END);
      /* Add name/ptrcontent section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "name_for_ptrcontent",
                   CURLFORM_PTRCONTENTS, buffer, CURLFORM_END);
      /* Add ptrname/ptrcontent section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_PTRNAME, namebuffer,
                CURLFORM_PTRCONTENTS, buffer, CURLFORM_NAMELENGTH,
                namelength, CURLFORM_END);
      /* Add name/ptrcontent/contenttype section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "html_code_with_hole",
                   CURLFORM_PTRCONTENTS, htmlbuffer,
                   CURLFORM_CONTENTSLENGTH, htmlbufferlength,
                   CURLFORM_CONTENTTYPE, "text/html", CURLFORM_END);
      /* Add simple file section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "picture",
                   CURLFORM_FILE, "my-face.jpg", CURLFORM_END);
      /* Add file/contenttype section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "picture",
                   CURLFORM_FILE, "my-face.jpg",
                   CURLFORM_CONTENTTYPE, "image/jpeg", CURLFORM_END);
      /* Add two file section */
      curl_formadd(&amp;post, &amp;last, CURLFORM_COPYNAME, "pictures",
                   CURLFORM_FILE, "my-face.jpg",
                   CURLFORM_FILE, "your-face.jpg", CURLFORM_END);
      /* Set the form info */
      curl_easy_setopt(curl, CURLOPT_HTTPPOST, post);



</PRE>
<H2>SEE ALSO</H2><PRE>
     <B>curl_easy_setopt(3)</B>,     <B>curl_formparse(3)</B>     [deprecated],
     <B>curl_formfree(3)</B>


</PRE>
<H2>BUGS</H2><PRE>
     Surely there are some, you tell me!
































</PRE>
<HR>
<ADDRESS>
Man(1) output converted with
<a href="http://www.oac.uci.edu/indiv/ehood/man2html.html">man2html</a>
</ADDRESS>
</BODY>
</HTML>
